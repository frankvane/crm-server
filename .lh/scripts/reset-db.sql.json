{
    "sourceFile": "scripts/reset-db.sql",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1745938415972,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1745938415972,
            "name": "Commit-0",
            "content": "USE [crm]\r\nGO\r\n\r\n-- 禁用外键约束\r\nEXEC sp_MSforeachtable \"ALTER TABLE ? NOCHECK CONSTRAINT ALL\"\r\nGO\r\n\r\n-- 删除所有表\r\nDECLARE @sql NVARCHAR(MAX) = N''\r\n\r\nSELECT @sql += N'\r\nDROP TABLE ' + QUOTENAME(SCHEMA_NAME(schema_id)) + N'.' + QUOTENAME(name) + N';'\r\nFROM sys.tables\r\nWHERE type = 'U'\r\nORDER BY CASE\r\n    WHEN name LIKE '%UserRoles%' THEN 1\r\n    WHEN name LIKE '%RolePermissions%' THEN 2\r\n    WHEN name LIKE '%RefreshTokens%' THEN 3\r\n    WHEN name LIKE '%Users%' THEN 4\r\n    WHEN name LIKE '%Roles%' THEN 5\r\n    WHEN name LIKE '%Permissions%' THEN 6\r\n    ELSE 7\r\nEND\r\n\r\nEXEC sp_executesql @sql\r\nGO\r\n\r\n-- 启用外键约束\r\nEXEC sp_MSforeachtable \"ALTER TABLE ? WITH CHECK CHECK CONSTRAINT ALL\"\r\nGO"
        }
    ]
}