{
    "sourceFile": "models/resource.model.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1746007654593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746007695064,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,22 +4,24 @@\n   const Resource = sequelize.define('Resource', {\r\n     name: {\r\n       type: DataTypes.STRING,\r\n       allowNull: false,\r\n-      comment: '资源名称',\r\n+      unique: true,\r\n     },\r\n+    type: {\r\n+      type: DataTypes.STRING,\r\n+      allowNull: false,\r\n+    },\r\n+    description: {\r\n+      type: DataTypes.STRING,\r\n+      allowNull: true,\r\n+    },\r\n     code: {\r\n       type: DataTypes.STRING,\r\n       allowNull: false,\r\n       unique: true,\r\n       comment: '资源代码',\r\n     },\r\n-    type: {\r\n-      type: DataTypes.ENUM('menu', 'button'),\r\n-      allowNull: false,\r\n-      defaultValue: 'menu',\r\n-      comment: '资源类型：菜单或按钮',\r\n-    },\r\n     path: {\r\n       type: DataTypes.STRING,\r\n       allowNull: true,\r\n       comment: '前端路由路径',\r\n"
                },
                {
                    "date": 1746008109176,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n-const { DataTypes } = require('sequelize');\r\n+const { DataTypes } = require(\"sequelize\");\r\n \r\n module.exports = (sequelize) => {\r\n-  const Resource = sequelize.define('Resource', {\r\n+  const Resource = sequelize.define(\"Resource\", {\r\n     name: {\r\n       type: DataTypes.STRING,\r\n       allowNull: false,\r\n       unique: true,\r\n@@ -18,59 +18,59 @@\n     code: {\r\n       type: DataTypes.STRING,\r\n       allowNull: false,\r\n       unique: true,\r\n-      comment: '资源代码',\r\n+      comment: \"资源代码\",\r\n     },\r\n     path: {\r\n       type: DataTypes.STRING,\r\n       allowNull: true,\r\n-      comment: '前端路由路径',\r\n+      comment: \"前端路由路径\",\r\n     },\r\n     parentId: {\r\n       type: DataTypes.INTEGER,\r\n       allowNull: true,\r\n-      comment: '父级资源ID',\r\n+      comment: \"父级资源ID\",\r\n     },\r\n     component: {\r\n       type: DataTypes.STRING,\r\n       allowNull: true,\r\n-      comment: '前端组件路径',\r\n+      comment: \"前端组件路径\",\r\n     },\r\n     icon: {\r\n       type: DataTypes.STRING,\r\n       allowNull: true,\r\n-      comment: '图标标识',\r\n+      comment: \"图标标识\",\r\n     },\r\n     sort: {\r\n       type: DataTypes.INTEGER,\r\n       allowNull: false,\r\n       defaultValue: 0,\r\n-      comment: '排序',\r\n+      comment: \"排序\",\r\n     },\r\n     hidden: {\r\n       type: DataTypes.BOOLEAN,\r\n       allowNull: false,\r\n       defaultValue: false,\r\n-      comment: '是否隐藏',\r\n+      comment: \"是否隐藏\",\r\n     },\r\n     redirect: {\r\n       type: DataTypes.STRING,\r\n       allowNull: true,\r\n-      comment: '重定向路径',\r\n+      comment: \"重定向路径\",\r\n     },\r\n     alwaysShow: {\r\n       type: DataTypes.BOOLEAN,\r\n       allowNull: true,\r\n-      comment: '是否总是显示',\r\n+      comment: \"是否总是显示\",\r\n     },\r\n     meta: {\r\n       type: DataTypes.JSON,\r\n       allowNull: true,\r\n-      comment: '额外元数据',\r\n+      comment: \"额外元数据\",\r\n       defaultValue: {\r\n-        title: '',\r\n-        icon: '',\r\n+        title: \"\",\r\n+        icon: \"\",\r\n         noCache: false,\r\n         link: null,\r\n       },\r\n     },\r\n@@ -78,23 +78,23 @@\n \r\n   Resource.associate = (models) => {\r\n     // 自关联（树形结构）\r\n     Resource.belongsTo(Resource, {\r\n-      foreignKey: 'parentId',\r\n-      as: 'parent',\r\n+      foreignKey: \"parentId\",\r\n+      as: \"parent\",\r\n     });\r\n     Resource.hasMany(Resource, {\r\n-      foreignKey: 'parentId',\r\n-      as: 'children',\r\n+      foreignKey: \"parentId\",\r\n+      as: \"children\",\r\n     });\r\n \r\n     // 与角色的多对多关系\r\n     Resource.belongsToMany(models.Role, {\r\n-      through: 'RoleResource',\r\n-      foreignKey: 'resourceId',\r\n-      otherKey: 'roleId',\r\n-      as: 'roles',\r\n+      through: \"RoleResource\",\r\n\\ No newline at end of file\n+      foreignKey: \"resourceId\",\r\n+      otherKey: \"roleId\",\r\n+      as: \"roles\",\r\n     });\r\n   };\r\n \r\n   return Resource;\r\n-}; \n+};\r\n"
                },
                {
                    "date": 1746008213648,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,5 +96,5 @@\n     });\r\n   };\r\n \r\n   return Resource;\r\n-};\n\\ No newline at end of file\n+};\r\n"
                },
                {
                    "date": 1746008274794,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,17 +63,24 @@\n       allowNull: true,\r\n       comment: \"是否总是显示\",\r\n     },\r\n     meta: {\r\n-      type: DataTypes.JSON,\r\n+      type: DataTypes.TEXT,\r\n       allowNull: true,\r\n       comment: \"额外元数据\",\r\n-      defaultValue: {\r\n+      defaultValue: JSON.stringify({\r\n         title: \"\",\r\n         icon: \"\",\r\n         noCache: false,\r\n         link: null,\r\n+      }),\r\n+      get() {\r\n+        const rawValue = this.getDataValue('meta');\r\n+        return rawValue ? JSON.parse(rawValue) : null;\r\n       },\r\n+      set(value) {\r\n+        this.setDataValue('meta', JSON.stringify(value));\r\n+      }\r\n     },\r\n   });\r\n \r\n   Resource.associate = (models) => {\r\n"
                },
                {
                    "date": 1746008299951,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,14 +73,14 @@\n         noCache: false,\r\n         link: null,\r\n       }),\r\n       get() {\r\n-        const rawValue = this.getDataValue('meta');\r\n+        const rawValue = this.getDataValue(\"meta\");\r\n         return rawValue ? JSON.parse(rawValue) : null;\r\n       },\r\n       set(value) {\r\n-        this.setDataValue('meta', JSON.stringify(value));\r\n-      }\r\n+        this.setDataValue(\"meta\", JSON.stringify(value));\r\n+      },\r\n     },\r\n   });\r\n \r\n   Resource.associate = (models) => {\r\n"
                }
            ],
            "date": 1746007654593,
            "name": "Commit-0",
            "content": "const { DataTypes } = require('sequelize');\r\n\r\nmodule.exports = (sequelize) => {\r\n  const Resource = sequelize.define('Resource', {\r\n    name: {\r\n      type: DataTypes.STRING,\r\n      allowNull: false,\r\n      comment: '资源名称',\r\n    },\r\n    code: {\r\n      type: DataTypes.STRING,\r\n      allowNull: false,\r\n      unique: true,\r\n      comment: '资源代码',\r\n    },\r\n    type: {\r\n      type: DataTypes.ENUM('menu', 'button'),\r\n      allowNull: false,\r\n      defaultValue: 'menu',\r\n      comment: '资源类型：菜单或按钮',\r\n    },\r\n    path: {\r\n      type: DataTypes.STRING,\r\n      allowNull: true,\r\n      comment: '前端路由路径',\r\n    },\r\n    parentId: {\r\n      type: DataTypes.INTEGER,\r\n      allowNull: true,\r\n      comment: '父级资源ID',\r\n    },\r\n    component: {\r\n      type: DataTypes.STRING,\r\n      allowNull: true,\r\n      comment: '前端组件路径',\r\n    },\r\n    icon: {\r\n      type: DataTypes.STRING,\r\n      allowNull: true,\r\n      comment: '图标标识',\r\n    },\r\n    sort: {\r\n      type: DataTypes.INTEGER,\r\n      allowNull: false,\r\n      defaultValue: 0,\r\n      comment: '排序',\r\n    },\r\n    hidden: {\r\n      type: DataTypes.BOOLEAN,\r\n      allowNull: false,\r\n      defaultValue: false,\r\n      comment: '是否隐藏',\r\n    },\r\n    redirect: {\r\n      type: DataTypes.STRING,\r\n      allowNull: true,\r\n      comment: '重定向路径',\r\n    },\r\n    alwaysShow: {\r\n      type: DataTypes.BOOLEAN,\r\n      allowNull: true,\r\n      comment: '是否总是显示',\r\n    },\r\n    meta: {\r\n      type: DataTypes.JSON,\r\n      allowNull: true,\r\n      comment: '额外元数据',\r\n      defaultValue: {\r\n        title: '',\r\n        icon: '',\r\n        noCache: false,\r\n        link: null,\r\n      },\r\n    },\r\n  });\r\n\r\n  Resource.associate = (models) => {\r\n    // 自关联（树形结构）\r\n    Resource.belongsTo(Resource, {\r\n      foreignKey: 'parentId',\r\n      as: 'parent',\r\n    });\r\n    Resource.hasMany(Resource, {\r\n      foreignKey: 'parentId',\r\n      as: 'children',\r\n    });\r\n\r\n    // 与角色的多对多关系\r\n    Resource.belongsToMany(models.Role, {\r\n      through: 'RoleResource',\r\n      foreignKey: 'resourceId',\r\n      otherKey: 'roleId',\r\n      as: 'roles',\r\n    });\r\n  };\r\n\r\n  return Resource;\r\n}; "
        }
    ]
}