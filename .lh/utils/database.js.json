{
    "sourceFile": "utils/database.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1746015667945,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746016449618,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,15 +2,19 @@\n \r\n async function clearDatabase() {\r\n   try {\r\n     // 禁用外键约束\r\n-    await sequelize.query(\"EXEC sp_MSforeachtable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'\");\r\n+    await sequelize.query(\r\n+      \"EXEC sp_MSforeachtable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'\"\r\n+    );\r\n \r\n     // 删除所有表中的数据\r\n     await sequelize.query(\"EXEC sp_MSforeachtable 'DELETE FROM ?'\");\r\n \r\n     // 重新启用外键约束\r\n-    await sequelize.query(\"EXEC sp_MSforeachtable 'ALTER TABLE ? CHECK CONSTRAINT ALL'\");\r\n+    await sequelize.query(\r\n+      \"EXEC sp_MSforeachtable 'ALTER TABLE ? CHECK CONSTRAINT ALL'\"\r\n+    );\r\n \r\n     console.log(\"数据库清理完成\");\r\n   } catch (error) {\r\n     console.error(\"清理数据库时出错:\", error);\r\n@@ -18,6 +22,6 @@\n   }\r\n }\r\n \r\n module.exports = {\r\n-  clearDatabase\r\n-}; \n\\ No newline at end of file\n+  clearDatabase,\r\n+};\r\n"
                }
            ],
            "date": 1746015667945,
            "name": "Commit-0",
            "content": "const { sequelize } = require(\"../models\");\r\n\r\nasync function clearDatabase() {\r\n  try {\r\n    // 禁用外键约束\r\n    await sequelize.query(\"EXEC sp_MSforeachtable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'\");\r\n\r\n    // 删除所有表中的数据\r\n    await sequelize.query(\"EXEC sp_MSforeachtable 'DELETE FROM ?'\");\r\n\r\n    // 重新启用外键约束\r\n    await sequelize.query(\"EXEC sp_MSforeachtable 'ALTER TABLE ? CHECK CONSTRAINT ALL'\");\r\n\r\n    console.log(\"数据库清理完成\");\r\n  } catch (error) {\r\n    console.error(\"清理数据库时出错:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nmodule.exports = {\r\n  clearDatabase\r\n}; "
        }
    ]
}