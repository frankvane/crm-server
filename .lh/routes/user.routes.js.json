{
    "sourceFile": "routes/user.routes.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 10,
            "patches": [
                {
                    "date": 1745880383418,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1745880496795,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,22 @@\n-const express = require('express');\r\n+const express = require(\"express\");\r\n const router = express.Router();\r\n-const userController = require('../controllers/user.controller');\r\n-const auth = require('../middlewares/auth');\r\n-const rbac = require('../middlewares/rbac');\r\n+const userController = require(\"../controllers/user.controller\");\r\n+const auth = require(\"../middlewares/auth\");\r\n+const rbac = require(\"../middlewares/rbac\");\r\n \r\n // 创建用户（需要admin权限）\r\n-router.post('/', [auth, rbac('create_user')], userController.create);\r\n+router.post(\"/\", [auth, rbac(\"create_user\")], userController.create);\r\n \r\n // 获取用户列表（需要view_users权限）\r\n-router.get('/', [auth, rbac('view_users')], userController.list);\r\n+router.get(\"/\", [auth, rbac(\"view_users\")], userController.list);\r\n \r\n // 获取单个用户（需要view_users权限）\r\n-router.get('/:id', [auth, rbac('view_users')], userController.getById);\r\n+router.get(\"/:id\", [auth, rbac(\"view_users\")], userController.getById);\r\n \r\n\\ No newline at end of file\n // 更新用户（需要update_user权限）\r\n-router.put('/:id', [auth, rbac('update_user')], userController.update);\r\n+router.put(\"/:id\", [auth, rbac(\"update_user\")], userController.update);\r\n \r\n // 删除用户（需要delete_user权限）\r\n-router.delete('/:id', [auth, rbac('delete_user')], userController.delete);\r\n+router.delete(\"/:id\", [auth, rbac(\"delete_user\")], userController.delete);\r\n \r\n-module.exports = router;\n+module.exports = router;\r\n"
                },
                {
                    "date": 1745880710248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,5 +18,5 @@\n \r\n // 删除用户（需要delete_user权限）\r\n router.delete(\"/:id\", [auth, rbac(\"delete_user\")], userController.delete);\r\n \r\n-module.exports = router;\n\\ No newline at end of file\n+module.exports = router;\r\n"
                },
                {
                    "date": 1745926425939,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,21 @@\n const express = require(\"express\");\r\n const router = express.Router();\r\n const userController = require(\"../controllers/user.controller\");\r\n-const auth = require(\"../middlewares/auth\");\r\n-const rbac = require(\"../middlewares/rbac\");\r\n+const { authJwt, rbac } = require(\"../middlewares\");\r\n \r\n-// 创建用户（需要admin权限）\r\n-router.post(\"/\", [auth, rbac(\"create_user\")], userController.create);\r\n+// 创建用户（需要create_user权限）\r\n+router.post(\"/\", [authJwt.verifyToken, rbac.checkPermission(\"create_user\")], userController.create);\r\n \r\n // 获取用户列表（需要view_users权限）\r\n-router.get(\"/\", [auth, rbac(\"view_users\")], userController.list);\r\n+router.get(\"/\", [authJwt.verifyToken, rbac.checkPermission(\"view_users\")], userController.list);\r\n \r\n // 获取单个用户（需要view_users权限）\r\n-router.get(\"/:id\", [auth, rbac(\"view_users\")], userController.getById);\r\n+router.get(\"/:id\", [authJwt.verifyToken, rbac.checkPermission(\"view_users\")], userController.getById);\r\n \r\n // 更新用户（需要update_user权限）\r\n-router.put(\"/:id\", [auth, rbac(\"update_user\")], userController.update);\r\n+router.put(\"/:id\", [authJwt.verifyToken, rbac.checkPermission(\"update_user\")], userController.update);\r\n \r\n // 删除用户（需要delete_user权限）\r\n-router.delete(\"/:id\", [auth, rbac(\"delete_user\")], userController.delete);\r\n+router.delete(\"/:id\", [authJwt.verifyToken, rbac.checkPermission(\"delete_user\")], userController.delete);\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1745926462114,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,19 +3,39 @@\n const userController = require(\"../controllers/user.controller\");\r\n const { authJwt, rbac } = require(\"../middlewares\");\r\n \r\n // 创建用户（需要create_user权限）\r\n-router.post(\"/\", [authJwt.verifyToken, rbac.checkPermission(\"create_user\")], userController.create);\r\n+router.post(\r\n+  \"/\",\r\n+  [authJwt.verifyToken, rbac.checkPermission(\"create_user\")],\r\n+  userController.create\r\n+);\r\n \r\n // 获取用户列表（需要view_users权限）\r\n-router.get(\"/\", [authJwt.verifyToken, rbac.checkPermission(\"view_users\")], userController.list);\r\n+router.get(\r\n+  \"/\",\r\n+  [authJwt.verifyToken, rbac.checkPermission(\"view_users\")],\r\n+  userController.list\r\n+);\r\n \r\n // 获取单个用户（需要view_users权限）\r\n-router.get(\"/:id\", [authJwt.verifyToken, rbac.checkPermission(\"view_users\")], userController.getById);\r\n+router.get(\r\n+  \"/:id\",\r\n+  [authJwt.verifyToken, rbac.checkPermission(\"view_users\")],\r\n+  userController.getById\r\n+);\r\n \r\n // 更新用户（需要update_user权限）\r\n-router.put(\"/:id\", [authJwt.verifyToken, rbac.checkPermission(\"update_user\")], userController.update);\r\n+router.put(\r\n+  \"/:id\",\r\n+  [authJwt.verifyToken, rbac.checkPermission(\"update_user\")],\r\n+  userController.update\r\n+);\r\n \r\n // 删除用户（需要delete_user权限）\r\n-router.delete(\"/:id\", [authJwt.verifyToken, rbac.checkPermission(\"delete_user\")], userController.delete);\r\n+router.delete(\r\n+  \"/:id\",\r\n+  [authJwt.verifyToken, rbac.checkPermission(\"delete_user\")],\r\n+  userController.delete\r\n+);\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746016689097,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,41 +1,62 @@\n const express = require(\"express\");\r\n const router = express.Router();\r\n const userController = require(\"../controllers/user.controller\");\r\n-const { authJwt, rbac } = require(\"../middlewares\");\r\n+const { authJwt } = require(\"../middlewares\");\r\n \r\n // 创建用户（需要create_user权限）\r\n router.post(\r\n   \"/\",\r\n-  [authJwt.verifyToken, rbac.checkPermission(\"create_user\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"create_user\")],\r\n   userController.create\r\n );\r\n \r\n // 获取用户列表（需要view_users权限）\r\n router.get(\r\n   \"/\",\r\n-  [authJwt.verifyToken, rbac.checkPermission(\"view_users\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"view_users\")],\r\n   userController.list\r\n );\r\n \r\n // 获取单个用户（需要view_users权限）\r\n router.get(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, rbac.checkPermission(\"view_users\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"view_users\")],\r\n   userController.getById\r\n );\r\n \r\n // 更新用户（需要update_user权限）\r\n router.put(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, rbac.checkPermission(\"update_user\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"update_user\")],\r\n   userController.update\r\n );\r\n \r\n // 删除用户（需要delete_user权限）\r\n router.delete(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, rbac.checkPermission(\"delete_user\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"delete_user\")],\r\n   userController.delete\r\n );\r\n \r\n+// 修改用户密码\r\n+router.put(\r\n+  \"/:id/password\",\r\n+  [authJwt.verifyToken],\r\n+  userController.changePassword\r\n+);\r\n+\r\n+// 切换用户状态（需要update_user权限）\r\n+router.put(\r\n+  \"/:id/toggle-status\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"update_user\")],\r\n+  userController.toggleStatus\r\n+);\r\n+\r\n+// 批量删除用户（需要delete_user权限）\r\n+router.delete(\r\n+  \"/batch\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"delete_user\")],\r\n+  userController.batchDelete\r\n+);\r\n+\r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746032003313,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,5 +58,12 @@\n   [authJwt.verifyToken, authJwt.hasPermission(\"delete_user\")],\r\n   userController.batchDelete\r\n );\r\n \r\n+// 获取当前登录用户信息（含角色、菜单、按钮权限）\r\n+router.get(\r\n+  \"/me\",\r\n+  [authJwt.verifyToken],\r\n+  userController.me\r\n+);\r\n+\r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746032061830,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,11 +59,7 @@\n   userController.batchDelete\r\n );\r\n \r\n // 获取当前登录用户信息（含角色、菜单、按钮权限）\r\n-router.get(\r\n-  \"/me\",\r\n-  [authJwt.verifyToken],\r\n-  userController.me\r\n-);\r\n+router.get(\"/me\", [authJwt.verifyToken], userController.me);\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746051454736,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,7 +59,7 @@\n   userController.batchDelete\r\n );\r\n \r\n // 获取当前登录用户信息（含角色、菜单、按钮权限）\r\n-router.get(\"/me\", [authJwt.verifyToken], userController.me);\r\n+router.get(\"/me\",userController.me);\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746051486731,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,7 +59,7 @@\n   userController.batchDelete\r\n );\r\n \r\n // 获取当前登录用户信息（含角色、菜单、按钮权限）\r\n-router.get(\"/me\", userController.me);\r\n+router.get(\"/me\", [authJwt.verifyToken], userController.me);\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746052652012,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,7 +59,7 @@\n   userController.batchDelete\r\n );\r\n \r\n // 获取当前登录用户信息（含角色、菜单、按钮权限）\r\n-router.get(\"/me\", [authJwt.verifyToken], userController.me);\r\n+router.get(\"/me\", [authJwt.verifyToken]);\r\n \r\n module.exports = router;\r\n"
                }
            ],
            "date": 1745880383418,
            "name": "Commit-0",
            "content": "const express = require('express');\r\nconst router = express.Router();\r\nconst userController = require('../controllers/user.controller');\r\nconst auth = require('../middlewares/auth');\r\nconst rbac = require('../middlewares/rbac');\r\n\r\n// 创建用户（需要admin权限）\r\nrouter.post('/', [auth, rbac('create_user')], userController.create);\r\n\r\n// 获取用户列表（需要view_users权限）\r\nrouter.get('/', [auth, rbac('view_users')], userController.list);\r\n\r\n// 获取单个用户（需要view_users权限）\r\nrouter.get('/:id', [auth, rbac('view_users')], userController.getById);\r\n\r\n// 更新用户（需要update_user权限）\r\nrouter.put('/:id', [auth, rbac('update_user')], userController.update);\r\n\r\n// 删除用户（需要delete_user权限）\r\nrouter.delete('/:id', [auth, rbac('delete_user')], userController.delete);\r\n\r\nmodule.exports = router;"
        }
    ]
}