{
    "sourceFile": "routes/resource.routes.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1746022475712,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746024865566,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,5 +37,5 @@\n   [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n   resourceController.delete\r\n );\r\n \r\n-module.exports = router;\n\\ No newline at end of file\n+module.exports = router;\r\n"
                },
                {
                    "date": 1746065676376,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,40 +2,40 @@\n const router = express.Router();\r\n const resourceController = require(\"../controllers/resource.controller\");\r\n const { authJwt } = require(\"../middlewares\");\r\n \r\n-// 创建资源（需要manage_resources权限）\r\n+// 创建资源（修改为使用正确的权限格式）\r\n router.post(\r\n   \"/\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:add\")],\r\n   resourceController.create\r\n );\r\n \r\n-// 获取资源列表（需要view_resources权限）\r\n+// 获取资源列表（由于没有view，使用edit权限）\r\n router.get(\r\n   \"/\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"view_resources\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n   resourceController.list\r\n );\r\n \r\n-// 获取单个资源（需要view_resources权限）\r\n+// 获取单个资源（由于没有view，使用edit权限）\r\n router.get(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"view_resources\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n   resourceController.getById\r\n );\r\n \r\n-// 更新资源（需要manage_resources权限）\r\n+// 更新资源\r\n router.put(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n   resourceController.update\r\n );\r\n \r\n-// 删除资源（需要manage_resources权限）\r\n+// 删除资源\r\n router.delete(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:delete\")],\r\n   resourceController.delete\r\n );\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746149731464,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,15 @@\n const router = express.Router();\r\n const resourceController = require(\"../controllers/resource.controller\");\r\n const { authJwt } = require(\"../middlewares\");\r\n \r\n+// 获取资源树\r\n+router.get(\r\n+  \"/tree\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  resourceController.tree\r\n+);\r\n+\r\n // 创建资源（修改为使用正确的权限格式）\r\n router.post(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:add\")],\r\n"
                },
                {
                    "date": 1746151652718,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,13 @@\n const express = require(\"express\");\r\n const router = express.Router();\r\n const resourceController = require(\"../controllers/resource.controller\");\r\n+const resourceActionRoutes = require(\"./resourceAction.routes\");\r\n const { authJwt } = require(\"../middlewares\");\r\n \r\n+// 资源操作相关路由\r\n+router.use(\"/\", resourceActionRoutes);\r\n+\r\n // 获取资源树\r\n router.get(\r\n   \"/tree\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n"
                },
                {
                    "date": 1746190068077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,8 +13,15 @@\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n   resourceController.tree\r\n );\r\n \r\n+// 获取资源树及其下所有按钮权限\r\n+router.get(\r\n+  \"/tree-with-actions\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  resourceController.treeWithActions\r\n+);\r\n+\r\n // 创建资源（修改为使用正确的权限格式）\r\n router.post(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:add\")],\r\n"
                },
                {
                    "date": 1746208308057,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,51 +9,51 @@\n \r\n // 获取资源树\r\n router.get(\r\n   \"/tree\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.tree\r\n );\r\n \r\n // 获取资源树及其下所有按钮权限\r\n router.get(\r\n   \"/tree-with-actions\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.treeWithActions\r\n );\r\n \r\n // 创建资源（修改为使用正确的权限格式）\r\n router.post(\r\n   \"/\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:add\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:add\")],\r\n   resourceController.create\r\n );\r\n \r\n // 获取资源列表（由于没有view，使用edit权限）\r\n router.get(\r\n   \"/\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.list\r\n );\r\n \r\n // 获取单个资源（由于没有view，使用edit权限）\r\n router.get(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.getById\r\n );\r\n \r\n // 更新资源\r\n router.put(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:edit\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.update\r\n );\r\n \r\n // 删除资源\r\n router.delete(\r\n   \"/:id\",\r\n-  [authJwt.verifyToken, authJwt.hasPermission(\"system:resource:delete\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:delete\")],\r\n   resourceController.delete\r\n );\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1747808015169,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,50 +6,175 @@\n \r\n // 资源操作相关路由\r\n router.use(\"/\", resourceActionRoutes);\r\n \r\n+/**\r\n+ * @swagger\r\n+ * /resources/tree:\r\n+ *   get:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 获取资源树\r\n+ *     description: 获取资源树结构。\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 资源树\r\n+ */\r\n // 获取资源树\r\n router.get(\r\n   \"/tree\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.tree\r\n );\r\n \r\n+/**\r\n+ * @swagger\r\n+ * /resources/tree-with-actions:\r\n+ *   get:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 获取资源树及其下所有按钮权限\r\n+ *     description: 获取资源树及其下所有按钮权限。\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 资源树及按钮权限\r\n+ */\r\n // 获取资源树及其下所有按钮权限\r\n router.get(\r\n   \"/tree-with-actions\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.treeWithActions\r\n );\r\n \r\n-// 创建资源（修改为使用正确的权限格式）\r\n+/**\r\n+ * @swagger\r\n+ * /resources:\r\n+ *   post:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 创建资源\r\n+ *     description: 新增一个资源。\r\n+ *     requestBody:\r\n+ *       required: true\r\n+ *       content:\r\n+ *         application/json:\r\n+ *           schema:\r\n+ *             type: object\r\n+ *             properties:\r\n+ *               name:\r\n+ *                 type: string\r\n+ *                 description: 资源名称\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 创建成功\r\n+ */\r\n+// 创建资源\r\n router.post(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:add\")],\r\n   resourceController.create\r\n );\r\n \r\n-// 获取资源列表（由于没有view，使用edit权限）\r\n+/**\r\n+ * @swagger\r\n+ * /resources:\r\n+ *   get:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 获取资源列表\r\n+ *     description: 获取所有资源，支持分页。\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 资源列表\r\n+ */\r\n+// 获取资源列表\r\n router.get(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.list\r\n );\r\n \r\n-// 获取单个资源（由于没有view，使用edit权限）\r\n+/**\r\n+ * @swagger\r\n+ * /resources/{id}:\r\n+ *   get:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 获取单个资源\r\n+ *     description: 根据ID获取资源详情。\r\n+ *     parameters:\r\n+ *       - in: path\r\n+ *         name: id\r\n+ *         schema:\r\n+ *           type: integer\r\n+ *         required: true\r\n+ *         description: 资源ID\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 资源详情\r\n+ */\r\n+// 获取单个资源\r\n router.get(\r\n   \"/:id\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.getById\r\n );\r\n \r\n+/**\r\n+ * @swagger\r\n+ * /resources/{id}:\r\n+ *   put:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 更新资源\r\n+ *     description: 根据ID更新资源信息。\r\n+ *     parameters:\r\n+ *       - in: path\r\n+ *         name: id\r\n+ *         schema:\r\n+ *           type: integer\r\n+ *         required: true\r\n+ *         description: 资源ID\r\n+ *     requestBody:\r\n+ *       required: true\r\n+ *       content:\r\n+ *         application/json:\r\n+ *           schema:\r\n+ *             type: object\r\n+ *             properties:\r\n+ *               name:\r\n+ *                 type: string\r\n+ *                 description: 资源名称\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 更新成功\r\n+ */\r\n // 更新资源\r\n router.put(\r\n   \"/:id\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:edit\")],\r\n   resourceController.update\r\n );\r\n \r\n+/**\r\n+ * @swagger\r\n+ * /resources/{id}:\r\n+ *   delete:\r\n+ *     tags:\r\n+ *       - 资源管理\r\n+ *     summary: 删除资源\r\n+ *     description: 根据ID删除资源。\r\n+ *     parameters:\r\n+ *       - in: path\r\n+ *         name: id\r\n+ *         schema:\r\n+ *           type: integer\r\n+ *         required: true\r\n+ *         description: 资源ID\r\n+ *     responses:\r\n+ *       200:\r\n+ *         description: 删除成功\r\n+ */\r\n // 删除资源\r\n router.delete(\r\n   \"/:id\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"permission:resources:delete\")],\r\n"
                }
            ],
            "date": 1746022475711,
            "name": "Commit-0",
            "content": "const express = require(\"express\");\r\nconst router = express.Router();\r\nconst resourceController = require(\"../controllers/resource.controller\");\r\nconst { authJwt } = require(\"../middlewares\");\r\n\r\n// 创建资源（需要manage_resources权限）\r\nrouter.post(\r\n  \"/\",\r\n  [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n  resourceController.create\r\n);\r\n\r\n// 获取资源列表（需要view_resources权限）\r\nrouter.get(\r\n  \"/\",\r\n  [authJwt.verifyToken, authJwt.hasPermission(\"view_resources\")],\r\n  resourceController.list\r\n);\r\n\r\n// 获取单个资源（需要view_resources权限）\r\nrouter.get(\r\n  \"/:id\",\r\n  [authJwt.verifyToken, authJwt.hasPermission(\"view_resources\")],\r\n  resourceController.getById\r\n);\r\n\r\n// 更新资源（需要manage_resources权限）\r\nrouter.put(\r\n  \"/:id\",\r\n  [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n  resourceController.update\r\n);\r\n\r\n// 删除资源（需要manage_resources权限）\r\nrouter.delete(\r\n  \"/:id\",\r\n  [authJwt.verifyToken, authJwt.hasPermission(\"manage_resources\")],\r\n  resourceController.delete\r\n);\r\n\r\nmodule.exports = router;"
        }
    ]
}