{
    "sourceFile": "routes/role.routes.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1745936740995,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1745936820067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,5 +42,5 @@\n   checkPermission(\"manage_roles\"),\r\n   roleController.deleteRole\r\n );\r\n \r\n-module.exports = router;\n\\ No newline at end of file\n+module.exports = router;\r\n"
                },
                {
                    "date": 1745937080592,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,46 +1,46 @@\n const express = require(\"express\");\r\n const router = express.Router();\r\n const roleController = require(\"../controllers/role.controller\");\r\n-const { authenticateToken, checkPermission } = require(\"../middlewares/auth\");\r\n+const { authenticateToken, hasPermission } = require(\"../middlewares/auth\");\r\n \r\n // 创建角色\r\n router.post(\r\n   \"/\",\r\n   authenticateToken,\r\n-  checkPermission(\"manage_roles\"),\r\n+  hasPermission(\"manage_roles\"),\r\n   roleController.createRole\r\n );\r\n \r\n // 获取角色列表\r\n router.get(\r\n   \"/\",\r\n   authenticateToken,\r\n-  checkPermission(\"view_roles\"),\r\n+  hasPermission(\"view_roles\"),\r\n   roleController.getRoles\r\n );\r\n \r\n // 获取单个角色\r\n router.get(\r\n   \"/:id\",\r\n   authenticateToken,\r\n-  checkPermission(\"view_roles\"),\r\n+  hasPermission(\"view_roles\"),\r\n   roleController.getRole\r\n );\r\n \r\n // 更新角色\r\n router.put(\r\n   \"/:id\",\r\n   authenticateToken,\r\n-  checkPermission(\"manage_roles\"),\r\n+  hasPermission(\"manage_roles\"),\r\n   roleController.updateRole\r\n );\r\n \r\n // 删除角色\r\n router.delete(\r\n   \"/:id\",\r\n   authenticateToken,\r\n-  checkPermission(\"manage_roles\"),\r\n+  hasPermission(\"manage_roles\"),\r\n   roleController.deleteRole\r\n );\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1745937372087,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,46 +1,41 @@\n const express = require(\"express\");\r\n const router = express.Router();\r\n const roleController = require(\"../controllers/role.controller\");\r\n-const { authenticateToken, hasPermission } = require(\"../middlewares/auth\");\r\n+const { verifyToken, hasPermission } = require(\"../middlewares/auth\");\r\n \r\n // 创建角色\r\n router.post(\r\n   \"/\",\r\n-  authenticateToken,\r\n-  hasPermission(\"manage_roles\"),\r\n+  [verifyToken, hasPermission(\"manage_roles\")],\r\n   roleController.createRole\r\n );\r\n \r\n // 获取角色列表\r\n router.get(\r\n   \"/\",\r\n-  authenticateToken,\r\n-  hasPermission(\"view_roles\"),\r\n+  [verifyToken, hasPermission(\"view_roles\")],\r\n   roleController.getRoles\r\n );\r\n \r\n // 获取单个角色\r\n router.get(\r\n   \"/:id\",\r\n-  authenticateToken,\r\n-  hasPermission(\"view_roles\"),\r\n+  [verifyToken, hasPermission(\"view_roles\")],\r\n   roleController.getRole\r\n );\r\n \r\n // 更新角色\r\n router.put(\r\n   \"/:id\",\r\n-  authenticateToken,\r\n-  hasPermission(\"manage_roles\"),\r\n+  [verifyToken, hasPermission(\"manage_roles\")],\r\n   roleController.updateRole\r\n );\r\n \r\n // 删除角色\r\n router.delete(\r\n   \"/:id\",\r\n-  authenticateToken,\r\n-  hasPermission(\"manage_roles\"),\r\n+  [verifyToken, hasPermission(\"manage_roles\")],\r\n   roleController.deleteRole\r\n );\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746065676374,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,41 +1,41 @@\n const express = require(\"express\");\r\n const router = express.Router();\r\n const roleController = require(\"../controllers/role.controller\");\r\n-const { verifyToken, hasPermission } = require(\"../middlewares/auth\");\r\n+const { authJwt } = require(\"../middlewares\");\r\n \r\n // 创建角色\r\n router.post(\r\n   \"/\",\r\n-  [verifyToken, hasPermission(\"manage_roles\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:add\")],\r\n   roleController.createRole\r\n );\r\n \r\n // 获取角色列表\r\n router.get(\r\n   \"/\",\r\n-  [verifyToken, hasPermission(\"view_roles\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n   roleController.getRoles\r\n );\r\n \r\n // 获取单个角色\r\n router.get(\r\n   \"/:id\",\r\n-  [verifyToken, hasPermission(\"view_roles\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n   roleController.getRole\r\n );\r\n \r\n // 更新角色\r\n router.put(\r\n   \"/:id\",\r\n-  [verifyToken, hasPermission(\"manage_roles\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n   roleController.updateRole\r\n );\r\n \r\n // 删除角色\r\n router.delete(\r\n   \"/:id\",\r\n-  [verifyToken, hasPermission(\"manage_roles\")],\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:delete\")],\r\n   roleController.deleteRole\r\n );\r\n \r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746099047778,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,5 +37,17 @@\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:delete\")],\r\n   roleController.deleteRole\r\n );\r\n \r\n+// 切换角色状态\r\n+router\r\n+  .route(\"/:id/toggle-status\")\r\n+  .put(\r\n+    [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n+    roleController.toggleStatus\r\n+  )\r\n+  .patch(\r\n+    [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n+    roleController.toggleStatus\r\n+  );\r\n+\r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746143144746,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,37 +6,37 @@\n // 创建角色\r\n router.post(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:add\")],\r\n-  roleController.createRole\r\n+  roleController.create\r\n );\r\n \r\n // 获取角色列表\r\n router.get(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n-  roleController.getRoles\r\n+  roleController.list\r\n );\r\n \r\n // 获取单个角色\r\n router.get(\r\n   \"/:id\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n-  roleController.getRole\r\n+  roleController.detail\r\n );\r\n \r\n // 更新角色\r\n router.put(\r\n   \"/:id\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n-  roleController.updateRole\r\n+  roleController.update\r\n );\r\n \r\n // 删除角色\r\n router.delete(\r\n   \"/:id\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:delete\")],\r\n-  roleController.deleteRole\r\n+  roleController.delete\r\n );\r\n \r\n // 切换角色状态\r\n router\r\n@@ -49,5 +49,19 @@\n     [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n     roleController.toggleStatus\r\n   );\r\n \r\n+// 分配资源\r\n+router.post(\r\n+  \"/:roleId/resources\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n+  roleController.assignResources\r\n+);\r\n+\r\n+// 分配权限\r\n+router.post(\r\n+  \"/:roleId/permissions\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n+  roleController.assignPermissions\r\n+);\r\n+\r\n module.exports = router;\r\n"
                },
                {
                    "date": 1746143613845,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,8 +9,15 @@\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:add\")],\r\n   roleController.create\r\n );\r\n \r\n+// 获取所有角色（不分页）\r\n+router.get(\r\n+  \"/all\",\r\n+  [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n+  roleController.listAll\r\n+);\r\n+\r\n // 获取角色列表\r\n router.get(\r\n   \"/\",\r\n   [authJwt.verifyToken, authJwt.hasPermission(\"system:role:edit\")],\r\n"
                }
            ],
            "date": 1745936740995,
            "name": "Commit-0",
            "content": "const express = require(\"express\");\r\nconst router = express.Router();\r\nconst roleController = require(\"../controllers/role.controller\");\r\nconst { authenticateToken, checkPermission } = require(\"../middlewares/auth\");\r\n\r\n// 创建角色\r\nrouter.post(\r\n  \"/\",\r\n  authenticateToken,\r\n  checkPermission(\"manage_roles\"),\r\n  roleController.createRole\r\n);\r\n\r\n// 获取角色列表\r\nrouter.get(\r\n  \"/\",\r\n  authenticateToken,\r\n  checkPermission(\"view_roles\"),\r\n  roleController.getRoles\r\n);\r\n\r\n// 获取单个角色\r\nrouter.get(\r\n  \"/:id\",\r\n  authenticateToken,\r\n  checkPermission(\"view_roles\"),\r\n  roleController.getRole\r\n);\r\n\r\n// 更新角色\r\nrouter.put(\r\n  \"/:id\",\r\n  authenticateToken,\r\n  checkPermission(\"manage_roles\"),\r\n  roleController.updateRole\r\n);\r\n\r\n// 删除角色\r\nrouter.delete(\r\n  \"/:id\",\r\n  authenticateToken,\r\n  checkPermission(\"manage_roles\"),\r\n  roleController.deleteRole\r\n);\r\n\r\nmodule.exports = router;"
        }
    ]
}