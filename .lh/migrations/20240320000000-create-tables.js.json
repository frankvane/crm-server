{
    "sourceFile": "migrations/20240320000000-create-tables.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1745937725810,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1745937853996,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,28 @@\n \"use strict\";\r\n \r\n module.exports = {\r\n   up: async (queryInterface, Sequelize) => {\r\n+    // 创建 SequelizeMeta 表\r\n+    await queryInterface.createTable(\"SequelizeMeta\", {\r\n+      name: {\r\n+        type: Sequelize.STRING,\r\n+        allowNull: false,\r\n+        unique: true,\r\n+        primaryKey: true,\r\n+      },\r\n+    });\r\n+\r\n+    // 创建 SequelizeData 表\r\n+    await queryInterface.createTable(\"SequelizeData\", {\r\n+      name: {\r\n+        type: Sequelize.STRING,\r\n+        allowNull: false,\r\n+        unique: true,\r\n+        primaryKey: true,\r\n+      },\r\n+    });\r\n+\r\n     // 创建 Permissions 表\r\n     await queryInterface.createTable(\"Permissions\", {\r\n       id: {\r\n         allowNull: false,\r\n@@ -176,6 +196,8 @@\n     await queryInterface.dropTable(\"Users\");\r\n     await queryInterface.dropTable(\"RolePermissions\");\r\n     await queryInterface.dropTable(\"Roles\");\r\n     await queryInterface.dropTable(\"Permissions\");\r\n+    await queryInterface.dropTable(\"SequelizeData\");\r\n+    await queryInterface.dropTable(\"SequelizeMeta\");\r\n   },\r\n };\r\n"
                }
            ],
            "date": 1745937725810,
            "name": "Commit-0",
            "content": "'use strict';\r\n\r\nmodule.exports = {\r\n  up: async (queryInterface, Sequelize) => {\r\n    // 创建 Permissions 表\r\n    await queryInterface.createTable('Permissions', {\r\n      id: {\r\n        allowNull: false,\r\n        autoIncrement: true,\r\n        primaryKey: true,\r\n        type: Sequelize.INTEGER\r\n      },\r\n      name: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false,\r\n        unique: true\r\n      },\r\n      action: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false\r\n      },\r\n      resource: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false\r\n      },\r\n      description: {\r\n        type: Sequelize.STRING\r\n      },\r\n      createdAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      },\r\n      updatedAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      }\r\n    });\r\n\r\n    // 创建 Roles 表\r\n    await queryInterface.createTable('Roles', {\r\n      id: {\r\n        allowNull: false,\r\n        autoIncrement: true,\r\n        primaryKey: true,\r\n        type: Sequelize.INTEGER\r\n      },\r\n      name: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false,\r\n        unique: true\r\n      },\r\n      description: {\r\n        type: Sequelize.STRING\r\n      },\r\n      createdAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      },\r\n      updatedAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      }\r\n    });\r\n\r\n    // 创建 RolePermissions 表\r\n    await queryInterface.createTable('RolePermissions', {\r\n      id: {\r\n        allowNull: false,\r\n        autoIncrement: true,\r\n        primaryKey: true,\r\n        type: Sequelize.INTEGER\r\n      },\r\n      roleId: {\r\n        type: Sequelize.INTEGER,\r\n        allowNull: false,\r\n        references: {\r\n          model: 'Roles',\r\n          key: 'id'\r\n        },\r\n        onUpdate: 'CASCADE',\r\n        onDelete: 'CASCADE'\r\n      },\r\n      permissionId: {\r\n        type: Sequelize.INTEGER,\r\n        allowNull: false,\r\n        references: {\r\n          model: 'Permissions',\r\n          key: 'id'\r\n        },\r\n        onUpdate: 'CASCADE',\r\n        onDelete: 'CASCADE'\r\n      },\r\n      createdAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      },\r\n      updatedAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      }\r\n    });\r\n\r\n    // 创建 Users 表\r\n    await queryInterface.createTable('Users', {\r\n      id: {\r\n        allowNull: false,\r\n        autoIncrement: true,\r\n        primaryKey: true,\r\n        type: Sequelize.INTEGER\r\n      },\r\n      username: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false,\r\n        unique: true\r\n      },\r\n      password: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false\r\n      },\r\n      email: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false,\r\n        unique: true\r\n      },\r\n      createdAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      },\r\n      updatedAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      }\r\n    });\r\n\r\n    // 创建 UserRoles 表\r\n    await queryInterface.createTable('UserRoles', {\r\n      id: {\r\n        allowNull: false,\r\n        autoIncrement: true,\r\n        primaryKey: true,\r\n        type: Sequelize.INTEGER\r\n      },\r\n      userId: {\r\n        type: Sequelize.INTEGER,\r\n        allowNull: false,\r\n        references: {\r\n          model: 'Users',\r\n          key: 'id'\r\n        },\r\n        onUpdate: 'CASCADE',\r\n        onDelete: 'CASCADE'\r\n      },\r\n      roleId: {\r\n        type: Sequelize.INTEGER,\r\n        allowNull: false,\r\n        references: {\r\n          model: 'Roles',\r\n          key: 'id'\r\n        },\r\n        onUpdate: 'CASCADE',\r\n        onDelete: 'CASCADE'\r\n      },\r\n      createdAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      },\r\n      updatedAt: {\r\n        allowNull: false,\r\n        type: Sequelize.DATE\r\n      }\r\n    });\r\n  },\r\n\r\n  down: async (queryInterface, Sequelize) => {\r\n    await queryInterface.dropTable('UserRoles');\r\n    await queryInterface.dropTable('Users');\r\n    await queryInterface.dropTable('RolePermissions');\r\n    await queryInterface.dropTable('Roles');\r\n    await queryInterface.dropTable('Permissions');\r\n  }\r\n}; "
        }
    ]
}