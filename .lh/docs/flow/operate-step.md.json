{
    "sourceFile": "docs/flow/operate-step.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1746055167341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746055182914,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,15 +10,18 @@\n \r\n - **URL**: `/api/auth/login`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"username\": \"admin\",\r\n   \"password\": \"admin123\"\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -39,8 +42,9 @@\n \r\n - **URL**: `/api/users/me`\r\n - **Method**: `GET`\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -112,17 +116,20 @@\n \r\n - **URL**: `/api/users`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"username\": \"testuser\",\r\n   \"password\": \"test123\",\r\n   \"email\": \"test@example.com\",\r\n-  \"roleIds\": []  // 初始不分配角色\r\n+  \"roleIds\": [] // 初始不分配角色\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -144,18 +151,21 @@\n \r\n - **URL**: `/api/roles`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"name\": \"普通用户\",\r\n   \"code\": \"normal_user\",\r\n   \"description\": \"普通用户角色\",\r\n-  \"permissionIds\": [],  // 初始不分配权限\r\n-  \"resourceIds\": []     // 初始不分配资源\r\n+  \"permissionIds\": [], // 初始不分配权限\r\n+  \"resourceIds\": [] // 初始不分配资源\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -178,17 +188,20 @@\n \r\n - **URL**: `/api/permissions`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"name\": \"view_users\",\r\n   \"code\": \"view_users\",\r\n   \"description\": \"查看用户列表\",\r\n-  \"type\": \"button\"  // 按钮级权限\r\n+  \"type\": \"button\" // 按钮级权限\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -208,24 +221,27 @@\n \r\n - **URL**: `/api/resources`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"name\": \"用户管理\",\r\n   \"code\": \"system:user\",\r\n   \"path\": \"user\",\r\n   \"component\": \"system/user/index\",\r\n   \"type\": \"menu\",\r\n-  \"parentId\": 1,  // 父级菜单ID\r\n+  \"parentId\": 1, // 父级菜单ID\r\n   \"meta\": {\r\n     \"title\": \"用户管理\",\r\n     \"icon\": \"用户\",\r\n     \"noCache\": false\r\n   }\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -250,14 +266,17 @@\n \r\n - **URL**: `/api/roles/:id/permissions`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n-  \"permissionIds\": [1, 2, 3]  // 权限ID列表\r\n+  \"permissionIds\": [1, 2, 3] // 权限ID列表\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -289,14 +308,17 @@\n \r\n - **URL**: `/api/roles/:id/resources`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n-  \"resourceIds\": [1, 2]  // 资源ID列表\r\n+  \"resourceIds\": [1, 2] // 资源ID列表\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -325,14 +347,17 @@\n \r\n - **URL**: `/api/users/:id/roles`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n-  \"roleIds\": [2]  // 角色ID列表\r\n+  \"roleIds\": [2] // 角色ID列表\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -358,15 +383,18 @@\n \r\n - **URL**: `/api/auth/login`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"username\": \"testuser\",\r\n   \"password\": \"test123\"\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -385,8 +413,9 @@\n \r\n - **URL**: `/api/users/me`\r\n - **Method**: `GET`\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -427,32 +456,31 @@\n           }\r\n         ]\r\n       }\r\n     ],\r\n-    \"permissions\": [\r\n-      \"view_users\",\r\n-      \"create_user\",\r\n-      \"update_user\"\r\n-    ]\r\n+    \"permissions\": [\"view_users\", \"create_user\", \"update_user\"]\r\n   }\r\n }\r\n ```\r\n \r\n ## 注意事项\r\n \r\n 1. 权限分配顺序：\r\n+\r\n    - 先创建权限\r\n    - 再创建资源（菜单）\r\n    - 然后创建角色\r\n    - 给角色分配权限和资源\r\n    - 最后给用户分配角色\r\n \r\n 2. 权限类型：\r\n+\r\n    - 菜单级权限：控制菜单的显示/隐藏\r\n    - 按钮级权限：控制按钮的显示/隐藏\r\n    - 接口级权限：控制接口的访问权限\r\n \r\n 3. 资源类型：\r\n+\r\n    - 菜单：type = \"menu\"\r\n    - 按钮：type = \"button\"\r\n    - 接口：type = \"api\"\r\n \r\n@@ -460,5 +488,5 @@\n    - 创建：create_xxx\r\n    - 查看：view_xxx\r\n    - 更新：update_xxx\r\n    - 删除：delete_xxx\r\n-   - 管理：manage_xxx \n\\ No newline at end of file\n+   - 管理：manage_xxx\r\n"
                },
                {
                    "date": 1746055850408,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -181,67 +181,33 @@\n ```\r\n \r\n ## 4. 分配权限\r\n \r\n-### 4.1 创建权限\r\n+### 4.1 创建资源（菜单和按钮）\r\n \r\n-首先需要创建权限。\r\n+首先创建菜单资源，然后创建对应的按钮资源。\r\n \r\n-- **URL**: `/api/permissions`\r\n-- **Method**: `POST`\r\n-- **请求体**:\r\n+#### 4.1.1 创建菜单资源\r\n \r\n-```json\r\n-{\r\n-  \"name\": \"view_users\",\r\n-  \"code\": \"view_users\",\r\n-  \"description\": \"查看用户列表\",\r\n-  \"type\": \"button\" // 按钮级权限\r\n-}\r\n-```\r\n-\r\n-- **响应**:\r\n-\r\n-```json\r\n-{\r\n-  \"code\": 200,\r\n-  \"message\": \"Success\",\r\n-  \"data\": {\r\n-    \"id\": 1,\r\n-    \"name\": \"view_users\",\r\n-    \"code\": \"view_users\",\r\n-    \"description\": \"查看用户列表\",\r\n-    \"type\": \"button\"\r\n-  }\r\n-}\r\n-```\r\n-\r\n-### 4.2 创建资源（菜单）\r\n-\r\n-然后创建菜单资源。\r\n-\r\n - **URL**: `/api/resources`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n-\r\n ```json\r\n {\r\n   \"name\": \"用户管理\",\r\n   \"code\": \"system:user\",\r\n   \"path\": \"user\",\r\n   \"component\": \"system/user/index\",\r\n   \"type\": \"menu\",\r\n-  \"parentId\": 1, // 父级菜单ID\r\n+  \"parentId\": 1,  // 父级菜单ID\r\n   \"meta\": {\r\n     \"title\": \"用户管理\",\r\n     \"icon\": \"用户\",\r\n     \"noCache\": false\r\n   }\r\n }\r\n ```\r\n-\r\n - **响应**:\r\n-\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -261,64 +227,94 @@\n   }\r\n }\r\n ```\r\n \r\n-### 4.3 给角色分配权限\r\n+#### 4.1.2 创建按钮资源\r\n \r\n-- **URL**: `/api/roles/:id/permissions`\r\n-- **Method**: `PUT`\r\n+- **URL**: `/api/resources`\r\n+- **Method**: `POST`\r\n - **请求体**:\r\n-\r\n ```json\r\n {\r\n-  \"permissionIds\": [1, 2, 3] // 权限ID列表\r\n+  \"name\": \"查看用户\",\r\n+  \"code\": \"system:user:view\",\r\n+  \"type\": \"button\",\r\n+  \"parentId\": 2,  // 关联到用户管理菜单\r\n+  \"meta\": {\r\n+    \"title\": \"查看用户\",\r\n+    \"icon\": \"查看\"\r\n+  }\r\n }\r\n ```\r\n-\r\n - **响应**:\r\n+```json\r\n+{\r\n+  \"code\": 200,\r\n+  \"message\": \"Success\",\r\n+  \"data\": {\r\n+    \"id\": 3,\r\n+    \"name\": \"查看用户\",\r\n+    \"code\": \"system:user:view\",\r\n+    \"type\": \"button\",\r\n+    \"parentId\": 2,\r\n+    \"meta\": {\r\n+      \"title\": \"查看用户\",\r\n+      \"icon\": \"查看\"\r\n+    }\r\n+  }\r\n+}\r\n+```\r\n \r\n+### 4.2 创建权限\r\n+\r\n+为每个资源创建对应的权限。\r\n+\r\n+- **URL**: `/api/permissions`\r\n+- **Method**: `POST`\r\n+- **请求体**:\r\n ```json\r\n {\r\n+  \"name\": \"view_users\",\r\n+  \"code\": \"view_users\",\r\n+  \"description\": \"查看用户列表\",\r\n+  \"resourceId\": 3,  // 关联到\"查看用户\"按钮资源\r\n+  \"type\": \"button\"\r\n+}\r\n+```\r\n+- **响应**:\r\n+```json\r\n+{\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n   \"data\": {\r\n-    \"id\": 2,\r\n-    \"name\": \"普通用户\",\r\n-    \"permissions\": [\r\n-      {\r\n-        \"id\": 1,\r\n-        \"name\": \"view_users\",\r\n-        \"code\": \"view_users\"\r\n-      },\r\n-      {\r\n-        \"id\": 2,\r\n-        \"name\": \"create_user\",\r\n-        \"code\": \"create_user\"\r\n-      },\r\n-      {\r\n-        \"id\": 3,\r\n-        \"name\": \"update_user\",\r\n-        \"code\": \"update_user\"\r\n-      }\r\n-    ]\r\n+    \"id\": 1,\r\n+    \"name\": \"view_users\",\r\n+    \"code\": \"view_users\",\r\n+    \"description\": \"查看用户列表\",\r\n+    \"resourceId\": 3,\r\n+    \"type\": \"button\",\r\n+    \"resource\": {\r\n+      \"id\": 3,\r\n+      \"name\": \"查看用户\",\r\n+      \"code\": \"system:user:view\"\r\n+    }\r\n   }\r\n }\r\n ```\r\n \r\n-### 4.4 给角色分配资源（菜单）\r\n+### 4.3 给角色分配资源\r\n \r\n+分配资源时会自动包含对应的权限。\r\n+\r\n - **URL**: `/api/roles/:id/resources`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n-\r\n ```json\r\n {\r\n-  \"resourceIds\": [1, 2] // 资源ID列表\r\n+  \"resourceIds\": [2, 3]  // 包含菜单和按钮资源\r\n }\r\n ```\r\n-\r\n - **响应**:\r\n-\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -326,16 +322,26 @@\n     \"id\": 2,\r\n     \"name\": \"普通用户\",\r\n     \"resources\": [\r\n       {\r\n-        \"id\": 1,\r\n-        \"name\": \"系统管理\",\r\n-        \"path\": \"/system\"\r\n+        \"id\": 2,\r\n+        \"name\": \"用户管理\",\r\n+        \"type\": \"menu\",\r\n+        \"path\": \"user\",\r\n+        \"permissions\": []\r\n       },\r\n       {\r\n-        \"id\": 2,\r\n-        \"name\": \"用户管理\",\r\n-        \"path\": \"user\"\r\n+        \"id\": 3,\r\n+        \"name\": \"查看用户\",\r\n+        \"type\": \"button\",\r\n+        \"parentId\": 2,\r\n+        \"permissions\": [\r\n+          {\r\n+            \"id\": 1,\r\n+            \"name\": \"view_users\",\r\n+            \"code\": \"view_users\"\r\n+          }\r\n+        ]\r\n       }\r\n     ]\r\n   }\r\n }\r\n@@ -464,29 +470,30 @@\n \r\n ## 注意事项\r\n \r\n 1. 权限分配顺序：\r\n-\r\n-   - 先创建权限\r\n-   - 再创建资源（菜单）\r\n-   - 然后创建角色\r\n-   - 给角色分配权限和资源\r\n+   - 先创建资源（菜单和按钮）\r\n+   - 为资源创建对应的权限\r\n+   - 创建角色\r\n+   - 给角色分配资源（自动包含对应的权限）\r\n    - 最后给用户分配角色\r\n \r\n-2. 权限类型：\r\n+2. 资源类型：\r\n+   - 菜单（type = \"menu\"）：系统菜单项\r\n+   - 按钮（type = \"button\"）：菜单下的操作按钮\r\n+   - 每个按钮资源必须关联到其所属的菜单资源\r\n \r\n-   - 菜单级权限：控制菜单的显示/隐藏\r\n-   - 按钮级权限：控制按钮的显示/隐藏\r\n-   - 接口级权限：控制接口的访问权限\r\n+3. 权限与资源关系：\r\n+   - 每个资源都有对应的权限\r\n+   - 权限与资源是一对一的关系\r\n+   - 分配资源时会自动包含对应的权限\r\n \r\n-3. 资源类型：\r\n-\r\n-   - 菜单：type = \"menu\"\r\n-   - 按钮：type = \"button\"\r\n-   - 接口：type = \"api\"\r\n-\r\n 4. 权限命名规范：\r\n    - 创建：create_xxx\r\n    - 查看：view_xxx\r\n    - 更新：update_xxx\r\n    - 删除：delete_xxx\r\n    - 管理：manage_xxx\r\n+\r\n+5. 资源编码规范：\r\n+   - 菜单：system:module\r\n+   - 按钮：system:module:action\r\n"
                },
                {
                    "date": 1746055879329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -190,24 +190,27 @@\n \r\n - **URL**: `/api/resources`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"name\": \"用户管理\",\r\n   \"code\": \"system:user\",\r\n   \"path\": \"user\",\r\n   \"component\": \"system/user/index\",\r\n   \"type\": \"menu\",\r\n-  \"parentId\": 1,  // 父级菜单ID\r\n+  \"parentId\": 1, // 父级菜单ID\r\n   \"meta\": {\r\n     \"title\": \"用户管理\",\r\n     \"icon\": \"用户\",\r\n     \"noCache\": false\r\n   }\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -232,21 +235,24 @@\n \r\n - **URL**: `/api/resources`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"name\": \"查看用户\",\r\n   \"code\": \"system:user:view\",\r\n   \"type\": \"button\",\r\n-  \"parentId\": 2,  // 关联到用户管理菜单\r\n+  \"parentId\": 2, // 关联到用户管理菜单\r\n   \"meta\": {\r\n     \"title\": \"查看用户\",\r\n     \"icon\": \"查看\"\r\n   }\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -270,18 +276,21 @@\n \r\n - **URL**: `/api/permissions`\r\n - **Method**: `POST`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"name\": \"view_users\",\r\n   \"code\": \"view_users\",\r\n   \"description\": \"查看用户列表\",\r\n-  \"resourceId\": 3,  // 关联到\"查看用户\"按钮资源\r\n+  \"resourceId\": 3, // 关联到\"查看用户\"按钮资源\r\n   \"type\": \"button\"\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -307,14 +316,17 @@\n \r\n - **URL**: `/api/roles/:id/resources`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n-  \"resourceIds\": [2, 3]  // 包含菜单和按钮资源\r\n+  \"resourceIds\": [2, 3] // 包含菜单和按钮资源\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -470,25 +482,29 @@\n \r\n ## 注意事项\r\n \r\n 1. 权限分配顺序：\r\n+\r\n    - 先创建资源（菜单和按钮）\r\n    - 为资源创建对应的权限\r\n    - 创建角色\r\n    - 给角色分配资源（自动包含对应的权限）\r\n    - 最后给用户分配角色\r\n \r\n 2. 资源类型：\r\n+\r\n    - 菜单（type = \"menu\"）：系统菜单项\r\n    - 按钮（type = \"button\"）：菜单下的操作按钮\r\n    - 每个按钮资源必须关联到其所属的菜单资源\r\n \r\n 3. 权限与资源关系：\r\n+\r\n    - 每个资源都有对应的权限\r\n    - 权限与资源是一对一的关系\r\n    - 分配资源时会自动包含对应的权限\r\n \r\n 4. 权限命名规范：\r\n+\r\n    - 创建：create_xxx\r\n    - 查看：view_xxx\r\n    - 更新：update_xxx\r\n    - 删除：delete_xxx\r\n"
                },
                {
                    "date": 1746056188537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -311,22 +311,32 @@\n ```\r\n \r\n ### 4.3 给角色分配资源\r\n \r\n-分配资源时会自动包含对应的权限。\r\n+分配资源时可以同时指定该资源下的具体权限。\r\n \r\n - **URL**: `/api/roles/:id/resources`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n-\r\n ```json\r\n {\r\n-  \"resourceIds\": [2, 3] // 包含菜单和按钮资源\r\n+  \"resources\": [\r\n+    {\r\n+      \"resourceId\": 2,  // 用户管理菜单\r\n+      \"permissionIds\": []  // 菜单资源通常不需要具体权限\r\n+    },\r\n+    {\r\n+      \"resourceId\": 3,  // 查看用户按钮\r\n+      \"permissionIds\": [1]  // 分配查看权限\r\n+    },\r\n+    {\r\n+      \"resourceId\": 4,  // 编辑用户按钮\r\n+      \"permissionIds\": [2, 3]  // 分配查看和编辑权限\r\n+    }\r\n+  ]\r\n }\r\n ```\r\n-\r\n - **响应**:\r\n-\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -352,8 +362,26 @@\n             \"name\": \"view_users\",\r\n             \"code\": \"view_users\"\r\n           }\r\n         ]\r\n+      },\r\n+      {\r\n+        \"id\": 4,\r\n+        \"name\": \"编辑用户\",\r\n+        \"type\": \"button\",\r\n+        \"parentId\": 2,\r\n+        \"permissions\": [\r\n+          {\r\n+            \"id\": 2,\r\n+            \"name\": \"view_users\",\r\n+            \"code\": \"view_users\"\r\n+          },\r\n+          {\r\n+            \"id\": 3,\r\n+            \"name\": \"update_users\",\r\n+            \"code\": \"update_users\"\r\n+          }\r\n+        ]\r\n       }\r\n     ]\r\n   }\r\n }\r\n@@ -498,10 +526,11 @@\n \r\n 3. 权限与资源关系：\r\n \r\n    - 每个资源都有对应的权限\r\n-   - 权限与资源是一对一的关系\r\n-   - 分配资源时会自动包含对应的权限\r\n+   - 权限与资源是多对一的关系（一个资源可以有多个权限）\r\n+   - 分配资源时可以指定该资源下的具体权限组合\r\n+   - 菜单资源通常不需要具体权限，按钮资源需要指定权限\r\n \r\n 4. 权限命名规范：\r\n \r\n    - 创建：create_xxx\r\n"
                },
                {
                    "date": 1746056200764,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -316,27 +316,30 @@\n \r\n - **URL**: `/api/roles/:id/resources`\r\n - **Method**: `PUT`\r\n - **请求体**:\r\n+\r\n ```json\r\n {\r\n   \"resources\": [\r\n     {\r\n-      \"resourceId\": 2,  // 用户管理菜单\r\n-      \"permissionIds\": []  // 菜单资源通常不需要具体权限\r\n+      \"resourceId\": 2, // 用户管理菜单\r\n+      \"permissionIds\": [] // 菜单资源通常不需要具体权限\r\n     },\r\n     {\r\n-      \"resourceId\": 3,  // 查看用户按钮\r\n-      \"permissionIds\": [1]  // 分配查看权限\r\n+      \"resourceId\": 3, // 查看用户按钮\r\n+      \"permissionIds\": [1] // 分配查看权限\r\n     },\r\n     {\r\n-      \"resourceId\": 4,  // 编辑用户按钮\r\n-      \"permissionIds\": [2, 3]  // 分配查看和编辑权限\r\n+      \"resourceId\": 4, // 编辑用户按钮\r\n+      \"permissionIds\": [2, 3] // 分配查看和编辑权限\r\n     }\r\n   ]\r\n }\r\n ```\r\n+\r\n - **响应**:\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n"
                },
                {
                    "date": 1746056293930,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -399,9 +399,9 @@\n - **请求体**:\r\n \r\n ```json\r\n {\r\n-  \"roleIds\": [2] // 角色ID列表\r\n+  \"roleIds\": [2]  // 角色ID列表\r\n }\r\n ```\r\n \r\n - **响应**:\r\n@@ -416,9 +416,49 @@\n     \"roles\": [\r\n       {\r\n         \"id\": 2,\r\n         \"name\": \"普通用户\",\r\n-        \"code\": \"normal_user\"\r\n+        \"code\": \"normal_user\",\r\n+        \"resources\": [\r\n+          {\r\n+            \"id\": 2,\r\n+            \"name\": \"用户管理\",\r\n+            \"type\": \"menu\",\r\n+            \"path\": \"user\",\r\n+            \"permissions\": []\r\n+          },\r\n+          {\r\n+            \"id\": 3,\r\n+            \"name\": \"查看用户\",\r\n+            \"type\": \"button\",\r\n+            \"parentId\": 2,\r\n+            \"permissions\": [\r\n+              {\r\n+                \"id\": 1,\r\n+                \"name\": \"view_users\",\r\n+                \"code\": \"view_users\"\r\n+              }\r\n+            ]\r\n+          },\r\n+          {\r\n+            \"id\": 4,\r\n+            \"name\": \"编辑用户\",\r\n+            \"type\": \"button\",\r\n+            \"parentId\": 2,\r\n+            \"permissions\": [\r\n+              {\r\n+                \"id\": 2,\r\n+                \"name\": \"view_users\",\r\n+                \"code\": \"view_users\"\r\n+              },\r\n+              {\r\n+                \"id\": 3,\r\n+                \"name\": \"update_users\",\r\n+                \"code\": \"update_users\"\r\n+              }\r\n+            ]\r\n+          }\r\n+        ]\r\n       }\r\n     ]\r\n   }\r\n }\r\n"
                },
                {
                    "date": 1746056310878,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -399,9 +399,9 @@\n - **请求体**:\r\n \r\n ```json\r\n {\r\n-  \"roleIds\": [2]  // 角色ID列表\r\n+  \"roleIds\": [2] // 角色ID列表\r\n }\r\n ```\r\n \r\n - **响应**:\r\n"
                }
            ],
            "date": 1746055167341,
            "name": "Commit-0",
            "content": "# RBAC 权限系统操作步骤\r\n\r\n本文档详细说明了 RBAC 权限系统的操作流程，包括管理员登录、用户管理、角色管理、权限分配等步骤。\r\n\r\n## 1. 管理员登录\r\n\r\n管理员登录后可以访问所有菜单和功能。\r\n\r\n### 1.1 登录接口\r\n\r\n- **URL**: `/api/auth/login`\r\n- **Method**: `POST`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"username\": \"admin\",\r\n  \"password\": \"admin123\"\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\r\n    \"user\": {\r\n      \"id\": 1,\r\n      \"username\": \"admin\",\r\n      \"email\": \"admin@example.com\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n### 1.2 获取用户信息\r\n\r\n登录成功后，系统会自动获取用户信息，包括菜单和权限。\r\n\r\n- **URL**: `/api/users/me`\r\n- **Method**: `GET`\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"user\": {\r\n      \"id\": 1,\r\n      \"username\": \"admin\",\r\n      \"email\": \"admin@example.com\",\r\n      \"status\": 1\r\n    },\r\n    \"roles\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"超级管理员\",\r\n        \"code\": \"super_admin\"\r\n      }\r\n    ],\r\n    \"routes\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"系统管理\",\r\n        \"path\": \"/system\",\r\n        \"component\": \"Layout\",\r\n        \"meta\": {\r\n          \"title\": \"系统管理\",\r\n          \"icon\": \"系统\"\r\n        },\r\n        \"children\": [\r\n          {\r\n            \"id\": 2,\r\n            \"name\": \"用户管理\",\r\n            \"path\": \"user\",\r\n            \"component\": \"system/user/index\",\r\n            \"meta\": {\r\n              \"title\": \"用户管理\",\r\n              \"icon\": \"用户\"\r\n            }\r\n          },\r\n          {\r\n            \"id\": 3,\r\n            \"name\": \"角色管理\",\r\n            \"path\": \"role\",\r\n            \"component\": \"system/role/index\",\r\n            \"meta\": {\r\n              \"title\": \"角色管理\",\r\n              \"icon\": \"角色\"\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    \"permissions\": [\r\n      \"create_user\",\r\n      \"view_users\",\r\n      \"update_user\",\r\n      \"delete_user\",\r\n      \"manage_roles\",\r\n      \"view_roles\",\r\n      \"manage_resources\",\r\n      \"view_resources\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n## 2. 创建新用户\r\n\r\n### 2.1 创建用户接口\r\n\r\n- **URL**: `/api/users`\r\n- **Method**: `POST`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"username\": \"testuser\",\r\n  \"password\": \"test123\",\r\n  \"email\": \"test@example.com\",\r\n  \"roleIds\": []  // 初始不分配角色\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 2,\r\n    \"username\": \"testuser\",\r\n    \"email\": \"test@example.com\",\r\n    \"status\": 1,\r\n    \"roles\": []\r\n  }\r\n}\r\n```\r\n\r\n## 3. 创建角色\r\n\r\n在给用户分配角色之前，需要先创建角色。\r\n\r\n### 3.1 创建角色接口\r\n\r\n- **URL**: `/api/roles`\r\n- **Method**: `POST`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"name\": \"普通用户\",\r\n  \"code\": \"normal_user\",\r\n  \"description\": \"普通用户角色\",\r\n  \"permissionIds\": [],  // 初始不分配权限\r\n  \"resourceIds\": []     // 初始不分配资源\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 2,\r\n    \"name\": \"普通用户\",\r\n    \"code\": \"normal_user\",\r\n    \"description\": \"普通用户角色\",\r\n    \"permissions\": [],\r\n    \"resources\": []\r\n  }\r\n}\r\n```\r\n\r\n## 4. 分配权限\r\n\r\n### 4.1 创建权限\r\n\r\n首先需要创建权限。\r\n\r\n- **URL**: `/api/permissions`\r\n- **Method**: `POST`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"name\": \"view_users\",\r\n  \"code\": \"view_users\",\r\n  \"description\": \"查看用户列表\",\r\n  \"type\": \"button\"  // 按钮级权限\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 1,\r\n    \"name\": \"view_users\",\r\n    \"code\": \"view_users\",\r\n    \"description\": \"查看用户列表\",\r\n    \"type\": \"button\"\r\n  }\r\n}\r\n```\r\n\r\n### 4.2 创建资源（菜单）\r\n\r\n然后创建菜单资源。\r\n\r\n- **URL**: `/api/resources`\r\n- **Method**: `POST`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"name\": \"用户管理\",\r\n  \"code\": \"system:user\",\r\n  \"path\": \"user\",\r\n  \"component\": \"system/user/index\",\r\n  \"type\": \"menu\",\r\n  \"parentId\": 1,  // 父级菜单ID\r\n  \"meta\": {\r\n    \"title\": \"用户管理\",\r\n    \"icon\": \"用户\",\r\n    \"noCache\": false\r\n  }\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 2,\r\n    \"name\": \"用户管理\",\r\n    \"code\": \"system:user\",\r\n    \"path\": \"user\",\r\n    \"component\": \"system/user/index\",\r\n    \"type\": \"menu\",\r\n    \"parentId\": 1,\r\n    \"meta\": {\r\n      \"title\": \"用户管理\",\r\n      \"icon\": \"用户\",\r\n      \"noCache\": false\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n### 4.3 给角色分配权限\r\n\r\n- **URL**: `/api/roles/:id/permissions`\r\n- **Method**: `PUT`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"permissionIds\": [1, 2, 3]  // 权限ID列表\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 2,\r\n    \"name\": \"普通用户\",\r\n    \"permissions\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"view_users\",\r\n        \"code\": \"view_users\"\r\n      },\r\n      {\r\n        \"id\": 2,\r\n        \"name\": \"create_user\",\r\n        \"code\": \"create_user\"\r\n      },\r\n      {\r\n        \"id\": 3,\r\n        \"name\": \"update_user\",\r\n        \"code\": \"update_user\"\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n### 4.4 给角色分配资源（菜单）\r\n\r\n- **URL**: `/api/roles/:id/resources`\r\n- **Method**: `PUT`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"resourceIds\": [1, 2]  // 资源ID列表\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 2,\r\n    \"name\": \"普通用户\",\r\n    \"resources\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"系统管理\",\r\n        \"path\": \"/system\"\r\n      },\r\n      {\r\n        \"id\": 2,\r\n        \"name\": \"用户管理\",\r\n        \"path\": \"user\"\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n## 5. 给用户分配角色\r\n\r\n### 5.1 分配角色接口\r\n\r\n- **URL**: `/api/users/:id/roles`\r\n- **Method**: `PUT`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"roleIds\": [2]  // 角色ID列表\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"id\": 2,\r\n    \"username\": \"testuser\",\r\n    \"roles\": [\r\n      {\r\n        \"id\": 2,\r\n        \"name\": \"普通用户\",\r\n        \"code\": \"normal_user\"\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n## 6. 验证权限\r\n\r\n### 6.1 用户登录\r\n\r\n新用户登录后，系统会根据其角色返回对应的菜单和权限。\r\n\r\n- **URL**: `/api/auth/login`\r\n- **Method**: `POST`\r\n- **请求体**:\r\n```json\r\n{\r\n  \"username\": \"testuser\",\r\n  \"password\": \"test123\"\r\n}\r\n```\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\r\n    \"user\": {\r\n      \"id\": 2,\r\n      \"username\": \"testuser\",\r\n      \"email\": \"test@example.com\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n### 6.2 获取用户信息\r\n\r\n- **URL**: `/api/users/me`\r\n- **Method**: `GET`\r\n- **响应**:\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"user\": {\r\n      \"id\": 2,\r\n      \"username\": \"testuser\",\r\n      \"email\": \"test@example.com\",\r\n      \"status\": 1\r\n    },\r\n    \"roles\": [\r\n      {\r\n        \"id\": 2,\r\n        \"name\": \"普通用户\",\r\n        \"code\": \"normal_user\"\r\n      }\r\n    ],\r\n    \"routes\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"系统管理\",\r\n        \"path\": \"/system\",\r\n        \"component\": \"Layout\",\r\n        \"meta\": {\r\n          \"title\": \"系统管理\",\r\n          \"icon\": \"系统\"\r\n        },\r\n        \"children\": [\r\n          {\r\n            \"id\": 2,\r\n            \"name\": \"用户管理\",\r\n            \"path\": \"user\",\r\n            \"component\": \"system/user/index\",\r\n            \"meta\": {\r\n              \"title\": \"用户管理\",\r\n              \"icon\": \"用户\"\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    \"permissions\": [\r\n      \"view_users\",\r\n      \"create_user\",\r\n      \"update_user\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n## 注意事项\r\n\r\n1. 权限分配顺序：\r\n   - 先创建权限\r\n   - 再创建资源（菜单）\r\n   - 然后创建角色\r\n   - 给角色分配权限和资源\r\n   - 最后给用户分配角色\r\n\r\n2. 权限类型：\r\n   - 菜单级权限：控制菜单的显示/隐藏\r\n   - 按钮级权限：控制按钮的显示/隐藏\r\n   - 接口级权限：控制接口的访问权限\r\n\r\n3. 资源类型：\r\n   - 菜单：type = \"menu\"\r\n   - 按钮：type = \"button\"\r\n   - 接口：type = \"api\"\r\n\r\n4. 权限命名规范：\r\n   - 创建：create_xxx\r\n   - 查看：view_xxx\r\n   - 更新：update_xxx\r\n   - 删除：delete_xxx\r\n   - 管理：manage_xxx "
        }
    ]
}