{
    "sourceFile": "docs/api/user.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1746054542019,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746054554288,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -147,15 +147,17 @@\n - **Auth Required**: Yes\r\n - **Permissions Required**: None\r\n \r\n ### 请求头\r\n+\r\n ```\r\n Authorization: Bearer <token>\r\n ```\r\n \r\n ### 响应\r\n \r\n #### 成功响应 (200 OK)\r\n+\r\n ```json\r\n {\r\n   \"code\": 200,\r\n   \"message\": \"Success\",\r\n@@ -214,8 +216,9 @@\n \r\n #### 错误响应\r\n \r\n ##### 未授权 (401 Unauthorized)\r\n+\r\n ```json\r\n {\r\n   \"code\": 401,\r\n   \"message\": \"No token provided\",\r\n@@ -223,8 +226,9 @@\n }\r\n ```\r\n \r\n ##### 用户未找到 (404 Not Found)\r\n+\r\n ```json\r\n {\r\n   \"code\": 404,\r\n   \"message\": \"User not found\",\r\n@@ -234,20 +238,23 @@\n \r\n ### 说明\r\n \r\n - `user`: 用户基本信息\r\n-  - `id`: 用户ID\r\n+\r\n+  - `id`: 用户 ID\r\n   - `username`: 用户名\r\n   - `email`: 邮箱\r\n   - `status`: 状态（1: 启用, 0: 禁用）\r\n \r\n - `roles`: 用户角色列表\r\n-  - `id`: 角色ID\r\n+\r\n+  - `id`: 角色 ID\r\n   - `name`: 角色名称\r\n   - `code`: 角色编码\r\n \r\n - `routes`: 菜单路由（树形结构）\r\n-  - `id`: 路由ID\r\n+\r\n+  - `id`: 路由 ID\r\n   - `name`: 路由名称\r\n   - `path`: 路由路径\r\n   - `component`: 组件路径\r\n   - `meta`: 路由元信息\r\n"
                },
                {
                    "date": 1746072850135,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n \r\n ## 1. 创建用户\r\n \r\n - **接口**：`POST /api/users`\r\n-- **描述**：创建新用户（需要 create_user 权限）\r\n+- **描述**：创建新用户（需要 system:user:add 权限）\r\n - **认证**：需要有效的访问令牌（Bearer Token）\r\n - **请求头**：\r\n   ```\r\n   Authorization: Bearer <accessToken>\r\n@@ -20,15 +20,19 @@\n   ```\r\n - **响应**：\r\n   ```json\r\n   {\r\n-    \"id\": \"number\",\r\n-    \"username\": \"string\",\r\n-    \"email\": \"string\",\r\n-    \"status\": \"boolean\",\r\n-    \"createdAt\": \"string\",\r\n-    \"updatedAt\": \"string\",\r\n-    \"Roles\": [ ... ]\r\n+    \"success\": true,\r\n+    \"message\": \"User created successfully\",\r\n+    \"data\": {\r\n+      \"id\": \"number\",\r\n+      \"username\": \"string\",\r\n+      \"email\": \"string\",\r\n+      \"status\": \"number\",\r\n+      \"createdAt\": \"string\",\r\n+      \"updatedAt\": \"string\",\r\n+      \"roles\": [ ... ]\r\n+    }\r\n   }\r\n   ```\r\n - **错误**：\r\n   - 400: \"Username already exists\"\r\n@@ -38,25 +42,31 @@\n \r\n ## 2. 获取用户列表\r\n \r\n - **接口**：`GET /api/users`\r\n-- **描述**：获取用户列表（需要 view_users 权限）\r\n+- **描述**：获取用户列表（需要 system:user:edit 权限）\r\n - **认证**：需要有效的访问令牌（Bearer Token）\r\n - **请求头**：\r\n   ```\r\n   Authorization: Bearer <accessToken>\r\n   ```\r\n - **查询参数**：\r\n   - page: 页码（默认：1）\r\n-  - limit: 每页数量（默认：10）\r\n+  - pageSize: 每页数量（默认：10）\r\n   - search: 搜索关键词\r\n - **响应**：\r\n   ```json\r\n   {\r\n-    \"total\": \"number\",\r\n-    \"pages\": \"number\",\r\n-    \"currentPage\": \"number\",\r\n-    \"data\": [ ... ]\r\n+    \"success\": true,\r\n+    \"message\": \"Success\",\r\n+    \"data\": {\r\n+      \"list\": [ ... ],\r\n+      \"pagination\": {\r\n+        \"current\": \"number\",\r\n+        \"pageSize\": \"number\",\r\n+        \"total\": \"number\"\r\n+      }\r\n+    }\r\n   }\r\n   ```\r\n - **错误**：\r\n   - 401: \"No token provided\" / \"Invalid or expired token\"\r\n@@ -65,24 +75,28 @@\n \r\n ## 3. 获取单个用户\r\n \r\n - **接口**：`GET /api/users/:id`\r\n-- **描述**：获取指定用户信息（需要 view_users 权限）\r\n+- **描述**：获取指定用户信息（需要 system:user:edit 权限）\r\n - **认证**：需要有效的访问令牌（Bearer Token）\r\n - **请求头**：\r\n   ```\r\n   Authorization: Bearer <accessToken>\r\n   ```\r\n - **响应**：\r\n   ```json\r\n   {\r\n-    \"id\": \"number\",\r\n-    \"username\": \"string\",\r\n-    \"email\": \"string\",\r\n-    \"status\": \"boolean\",\r\n-    \"createdAt\": \"string\",\r\n-    \"updatedAt\": \"string\",\r\n-    \"Roles\": [ ... ]\r\n+    \"success\": true,\r\n+    \"message\": \"Success\",\r\n+    \"data\": {\r\n+      \"id\": \"number\",\r\n+      \"username\": \"string\",\r\n+      \"email\": \"string\",\r\n+      \"status\": \"number\",\r\n+      \"createdAt\": \"string\",\r\n+      \"updatedAt\": \"string\",\r\n+      \"roles\": [ ... ]\r\n+    }\r\n   }\r\n   ```\r\n - **错误**：\r\n   - 401: \"No token provided\" / \"Invalid or expired token\"\r\n@@ -92,9 +106,9 @@\n \r\n ## 4. 更新用户\r\n \r\n - **接口**：`PUT /api/users/:id`\r\n-- **描述**：更新指定用户信息（需要 update_user 权限）\r\n+- **描述**：更新指定用户信息（需要 system:user:edit 权限）\r\n - **认证**：需要有效的访问令牌（Bearer Token）\r\n - **请求头**：\r\n   ```\r\n   Authorization: Bearer <accessToken>\r\n@@ -104,9 +118,9 @@\n   {\r\n     \"username\": \"string\",\r\n     \"password\": \"string\",\r\n     \"email\": \"string\",\r\n-    \"status\": \"boolean\",\r\n+    \"status\": \"number\",\r\n     \"roleIds\": \"number[]\"\r\n   }\r\n   ```\r\n - **响应**：与获取单个用户接口相同\r\n@@ -119,48 +133,134 @@\n \r\n ## 5. 删除用户\r\n \r\n - **接口**：`DELETE /api/users/:id`\r\n-- **描述**：删除指定用户（需要 delete_user 权限）\r\n+- **描述**：删除指定用户（需要 system:user:delete 权限）\r\n - **认证**：需要有效的访问令牌（Bearer Token）\r\n - **请求头**：\r\n   ```\r\n   Authorization: Bearer <accessToken>\r\n   ```\r\n - **响应**：\r\n   ```json\r\n   {\r\n-    \"message\": \"User deleted successfully\"\r\n+    \"success\": true,\r\n+    \"message\": \"User deleted successfully\",\r\n+    \"data\": null\r\n   }\r\n   ```\r\n - **错误**：\r\n   - 401: \"No token provided\" / \"Invalid or expired token\"\r\n   - 403: \"Forbidden\"\r\n   - 404: \"User not found\"\r\n   - 500: \"Internal Server Error\"\r\n \r\n-## 获取当前登录用户信息\r\n+## 6. 修改用户密码\r\n \r\n-获取当前登录用户的详细信息，包括用户基本信息、角色、权限和菜单。\r\n+- **接口**：`PUT /api/users/:id/password`\r\n+- **描述**：修改指定用户的密码（用户本人或管理员）\r\n+- **认证**：需要有效的访问令牌（Bearer Token）\r\n+- **请求头**：\r\n+  ```\r\n+  Authorization: Bearer <accessToken>\r\n+  ```\r\n+- **请求体**：\r\n+  ```json\r\n+  {\r\n+    \"currentPassword\": \"string\", // 当前用户修改自己的密码时需要提供\r\n+    \"newPassword\": \"string\"\r\n+  }\r\n+  ```\r\n+- **响应**：\r\n+  ```json\r\n+  {\r\n+    \"success\": true,\r\n+    \"message\": \"Password changed successfully\",\r\n+    \"data\": null\r\n+  }\r\n+  ```\r\n+- **错误**：\r\n+  - 400: \"Current password is incorrect\"\r\n+  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n+  - 403: \"You can only change your own password\"\r\n+  - 404: \"User not found\"\r\n+  - 500: \"Internal Server Error\"\r\n \r\n-- **URL**: `/api/users/me`\r\n-- **Method**: `GET`\r\n-- **Auth Required**: Yes\r\n-- **Permissions Required**: None\r\n+## 7. 切换用户状态\r\n \r\n-### 请求头\r\n+- **接口**：`PUT /api/users/:id/toggle-status`\r\n+- **描述**：启用或禁用指定用户（需要 system:user:edit 权限）\r\n+- **认证**：需要有效的访问令牌（Bearer Token）\r\n+- **请求头**：\r\n+  ```\r\n+  Authorization: Bearer <accessToken>\r\n+  ```\r\n+- **响应**：\r\n+  ```json\r\n+  {\r\n+    \"success\": true,\r\n+    \"message\": \"User enabled/disabled successfully\",\r\n+    \"data\": {\r\n+      \"id\": \"number\",\r\n+      \"status\": \"number\"\r\n+    }\r\n+  }\r\n+  ```\r\n+- **错误**：\r\n+  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n+  - 403: \"Forbidden\"\r\n+  - 404: \"User not found\"\r\n+  - 500: \"Internal Server Error\"\r\n \r\n-```\r\n-Authorization: Bearer <token>\r\n-```\r\n+## 8. 批量删除用户\r\n \r\n+- **接口**：`DELETE /api/users/batch`\r\n+- **描述**：批量删除用户（需要 system:user:delete 权限）\r\n+- **认证**：需要有效的访问令牌（Bearer Token）\r\n+- **请求头**：\r\n+  ```\r\n+  Authorization: Bearer <accessToken>\r\n+  ```\r\n+- **请求体**：\r\n+  ```json\r\n+  {\r\n+    \"ids\": \"number[]\"\r\n+  }\r\n+  ```\r\n+- **响应**：\r\n+  ```json\r\n+  {\r\n+    \"success\": true,\r\n+    \"message\": \"Users deleted successfully\",\r\n+    \"data\": {\r\n+      \"deletedCount\": \"number\"\r\n+    }\r\n+  }\r\n+  ```\r\n+- **错误**：\r\n+  - 400: \"Invalid user IDs provided\"\r\n+  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n+  - 403: \"Forbidden\"\r\n+  - 500: \"Internal Server Error\"\r\n+\r\n+## 9. 获取当前登录用户信息\r\n+\r\n+- **接口**: `/api/users/me`\r\n+- **方法**: `GET`\r\n+- **描述**: 获取当前登录用户的详细信息，包括用户基本信息、角色、权限和菜单\r\n+- **认证**: 需要有效的访问令牌（Bearer Token）\r\n+- **请求头**：\r\n+  ```\r\n+  Authorization: Bearer <accessToken>\r\n+  ```\r\n+\r\n ### 响应\r\n \r\n #### 成功响应 (200 OK)\r\n \r\n ```json\r\n {\r\n-  \"code\": 200,\r\n+  \"success\": true,\r\n   \"message\": \"Success\",\r\n   \"data\": {\r\n     \"user\": {\r\n       \"id\": 1,\r\n@@ -203,13 +303,13 @@\n         ]\r\n       }\r\n     ],\r\n     \"permissions\": [\r\n-      \"create_user\",\r\n-      \"view_users\",\r\n-      \"update_user\",\r\n-      \"delete_user\",\r\n-      \"manage_roles\"\r\n+      \"system:user:add\",\r\n+      \"system:user:edit\",\r\n+      \"system:user:delete\",\r\n+      \"system:role:add\",\r\n+      \"system:role:edit\"\r\n     ]\r\n   }\r\n }\r\n ```\r\n@@ -219,9 +319,9 @@\n ##### 未授权 (401 Unauthorized)\r\n \r\n ```json\r\n {\r\n-  \"code\": 401,\r\n+  \"success\": false,\r\n   \"message\": \"No token provided\",\r\n   \"data\": null\r\n }\r\n ```\r\n@@ -229,31 +329,28 @@\n ##### 用户未找到 (404 Not Found)\r\n \r\n ```json\r\n {\r\n-  \"code\": 404,\r\n+  \"success\": false,\r\n   \"message\": \"User not found\",\r\n   \"data\": null\r\n }\r\n ```\r\n \r\n ### 说明\r\n \r\n - `user`: 用户基本信息\r\n-\r\n   - `id`: 用户 ID\r\n   - `username`: 用户名\r\n   - `email`: 邮箱\r\n   - `status`: 状态（1: 启用, 0: 禁用）\r\n \r\n - `roles`: 用户角色列表\r\n-\r\n   - `id`: 角色 ID\r\n   - `name`: 角色名称\r\n   - `code`: 角色编码\r\n \r\n - `routes`: 菜单路由（树形结构）\r\n-\r\n   - `id`: 路由 ID\r\n   - `name`: 路由名称\r\n   - `path`: 路由路径\r\n   - `component`: 组件路径\r\n@@ -264,5 +361,5 @@\n     - `link`: 外部链接\r\n   - `children`: 子路由\r\n \r\n - `permissions`: 权限列表\r\n-  - 包含所有以 `create_`、`view_`、`update_`、`delete_`、`manage_` 开头的权限\r\n+  - 采用 `{资源编码}:{操作}` 格式，如 `system:user:add`\r\n"
                }
            ],
            "date": 1746054542019,
            "name": "Commit-0",
            "content": "# 用户管理接口文档\r\n\r\n## 1. 创建用户\r\n\r\n- **接口**：`POST /api/users`\r\n- **描述**：创建新用户（需要 create_user 权限）\r\n- **认证**：需要有效的访问令牌（Bearer Token）\r\n- **请求头**：\r\n  ```\r\n  Authorization: Bearer <accessToken>\r\n  ```\r\n- **请求体**：\r\n  ```json\r\n  {\r\n    \"username\": \"string\",\r\n    \"password\": \"string\",\r\n    \"email\": \"string\",\r\n    \"roleIds\": \"number[]\"\r\n  }\r\n  ```\r\n- **响应**：\r\n  ```json\r\n  {\r\n    \"id\": \"number\",\r\n    \"username\": \"string\",\r\n    \"email\": \"string\",\r\n    \"status\": \"boolean\",\r\n    \"createdAt\": \"string\",\r\n    \"updatedAt\": \"string\",\r\n    \"Roles\": [ ... ]\r\n  }\r\n  ```\r\n- **错误**：\r\n  - 400: \"Username already exists\"\r\n  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n  - 403: \"Forbidden\"\r\n  - 500: \"Internal Server Error\"\r\n\r\n## 2. 获取用户列表\r\n\r\n- **接口**：`GET /api/users`\r\n- **描述**：获取用户列表（需要 view_users 权限）\r\n- **认证**：需要有效的访问令牌（Bearer Token）\r\n- **请求头**：\r\n  ```\r\n  Authorization: Bearer <accessToken>\r\n  ```\r\n- **查询参数**：\r\n  - page: 页码（默认：1）\r\n  - limit: 每页数量（默认：10）\r\n  - search: 搜索关键词\r\n- **响应**：\r\n  ```json\r\n  {\r\n    \"total\": \"number\",\r\n    \"pages\": \"number\",\r\n    \"currentPage\": \"number\",\r\n    \"data\": [ ... ]\r\n  }\r\n  ```\r\n- **错误**：\r\n  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n  - 403: \"Forbidden\"\r\n  - 500: \"Internal Server Error\"\r\n\r\n## 3. 获取单个用户\r\n\r\n- **接口**：`GET /api/users/:id`\r\n- **描述**：获取指定用户信息（需要 view_users 权限）\r\n- **认证**：需要有效的访问令牌（Bearer Token）\r\n- **请求头**：\r\n  ```\r\n  Authorization: Bearer <accessToken>\r\n  ```\r\n- **响应**：\r\n  ```json\r\n  {\r\n    \"id\": \"number\",\r\n    \"username\": \"string\",\r\n    \"email\": \"string\",\r\n    \"status\": \"boolean\",\r\n    \"createdAt\": \"string\",\r\n    \"updatedAt\": \"string\",\r\n    \"Roles\": [ ... ]\r\n  }\r\n  ```\r\n- **错误**：\r\n  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n  - 403: \"Forbidden\"\r\n  - 404: \"User not found\"\r\n  - 500: \"Internal Server Error\"\r\n\r\n## 4. 更新用户\r\n\r\n- **接口**：`PUT /api/users/:id`\r\n- **描述**：更新指定用户信息（需要 update_user 权限）\r\n- **认证**：需要有效的访问令牌（Bearer Token）\r\n- **请求头**：\r\n  ```\r\n  Authorization: Bearer <accessToken>\r\n  ```\r\n- **请求体**：\r\n  ```json\r\n  {\r\n    \"username\": \"string\",\r\n    \"password\": \"string\",\r\n    \"email\": \"string\",\r\n    \"status\": \"boolean\",\r\n    \"roleIds\": \"number[]\"\r\n  }\r\n  ```\r\n- **响应**：与获取单个用户接口相同\r\n- **错误**：\r\n  - 400: \"Username already exists\"\r\n  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n  - 403: \"Forbidden\"\r\n  - 404: \"User not found\"\r\n  - 500: \"Internal Server Error\"\r\n\r\n## 5. 删除用户\r\n\r\n- **接口**：`DELETE /api/users/:id`\r\n- **描述**：删除指定用户（需要 delete_user 权限）\r\n- **认证**：需要有效的访问令牌（Bearer Token）\r\n- **请求头**：\r\n  ```\r\n  Authorization: Bearer <accessToken>\r\n  ```\r\n- **响应**：\r\n  ```json\r\n  {\r\n    \"message\": \"User deleted successfully\"\r\n  }\r\n  ```\r\n- **错误**：\r\n  - 401: \"No token provided\" / \"Invalid or expired token\"\r\n  - 403: \"Forbidden\"\r\n  - 404: \"User not found\"\r\n  - 500: \"Internal Server Error\"\r\n\r\n## 获取当前登录用户信息\r\n\r\n获取当前登录用户的详细信息，包括用户基本信息、角色、权限和菜单。\r\n\r\n- **URL**: `/api/users/me`\r\n- **Method**: `GET`\r\n- **Auth Required**: Yes\r\n- **Permissions Required**: None\r\n\r\n### 请求头\r\n```\r\nAuthorization: Bearer <token>\r\n```\r\n\r\n### 响应\r\n\r\n#### 成功响应 (200 OK)\r\n```json\r\n{\r\n  \"code\": 200,\r\n  \"message\": \"Success\",\r\n  \"data\": {\r\n    \"user\": {\r\n      \"id\": 1,\r\n      \"username\": \"admin\",\r\n      \"email\": \"admin@example.com\",\r\n      \"status\": 1\r\n    },\r\n    \"roles\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"管理员\",\r\n        \"code\": \"admin\"\r\n      }\r\n    ],\r\n    \"routes\": [\r\n      {\r\n        \"id\": 1,\r\n        \"name\": \"系统管理\",\r\n        \"path\": \"/system\",\r\n        \"component\": \"Layout\",\r\n        \"meta\": {\r\n          \"title\": \"系统管理\",\r\n          \"icon\": \"系统\",\r\n          \"noCache\": false,\r\n          \"link\": null\r\n        },\r\n        \"children\": [\r\n          {\r\n            \"id\": 2,\r\n            \"name\": \"用户管理\",\r\n            \"path\": \"user\",\r\n            \"component\": \"system/user/index\",\r\n            \"meta\": {\r\n              \"title\": \"用户管理\",\r\n              \"icon\": \"#\",\r\n              \"noCache\": false,\r\n              \"link\": null\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    ],\r\n    \"permissions\": [\r\n      \"create_user\",\r\n      \"view_users\",\r\n      \"update_user\",\r\n      \"delete_user\",\r\n      \"manage_roles\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n#### 错误响应\r\n\r\n##### 未授权 (401 Unauthorized)\r\n```json\r\n{\r\n  \"code\": 401,\r\n  \"message\": \"No token provided\",\r\n  \"data\": null\r\n}\r\n```\r\n\r\n##### 用户未找到 (404 Not Found)\r\n```json\r\n{\r\n  \"code\": 404,\r\n  \"message\": \"User not found\",\r\n  \"data\": null\r\n}\r\n```\r\n\r\n### 说明\r\n\r\n- `user`: 用户基本信息\r\n  - `id`: 用户ID\r\n  - `username`: 用户名\r\n  - `email`: 邮箱\r\n  - `status`: 状态（1: 启用, 0: 禁用）\r\n\r\n- `roles`: 用户角色列表\r\n  - `id`: 角色ID\r\n  - `name`: 角色名称\r\n  - `code`: 角色编码\r\n\r\n- `routes`: 菜单路由（树形结构）\r\n  - `id`: 路由ID\r\n  - `name`: 路由名称\r\n  - `path`: 路由路径\r\n  - `component`: 组件路径\r\n  - `meta`: 路由元信息\r\n    - `title`: 菜单标题\r\n    - `icon`: 菜单图标\r\n    - `noCache`: 是否缓存\r\n    - `link`: 外部链接\r\n  - `children`: 子路由\r\n\r\n- `permissions`: 权限列表\r\n  - 包含所有以 `create_`、`view_`、`update_`、`delete_`、`manage_` 开头的权限\r\n"
        }
    ]
}